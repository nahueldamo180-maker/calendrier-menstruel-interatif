<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision Code de la Route - 40 Questions (SAUVEGARDE)</title>
    <!-- Chargement de Tailwind CSS pour un design moderne et responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configuration de la police Inter et d'un fond agr√©able */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }
    </style>
</head>
<body>

    <div id="quiz-container" class="w-full max-w-lg bg-white p-8 rounded-xl shadow-2xl transition-all duration-300">
        
        <!-- En-t√™te -->
        <header class="mb-6 text-center">
            <h1 class="text-3xl font-extrabold text-blue-800">Code de la Route üá´üá∑</h1>
            <p class="text-gray-600 mt-2 font-semibold">40 Questions | Objectif : 35/40</p>
        </header>

        <!-- Affichage du Score et de la Question Actuelle -->
        <div class="flex justify-between items-center mb-6 p-4 bg-blue-50 rounded-lg shadow-inner">
            <p id="score-display" class="text-lg font-medium text-blue-700">Score: 0</p>
            <p id="question-index-display" class="text-lg font-medium text-blue-700">Question 1 / 40</p>
        </div>

        <!-- Zone de la Question -->
        <div id="question-area">
            <p id="question-text" class="text-xl font-semibold text-gray-800 mb-6 leading-relaxed">Chargement de la question...</p>
            
            <!-- Conteneur pour les options de r√©ponse -->
            <div id="options-container" class="space-y-4">
                <!-- Les boutons de r√©ponse seront inject√©s ici par JavaScript -->
            </div>
            
            <!-- Message de Feedback (Correct/Incorrect) -->
            <div id="feedback-message" class="mt-6 p-3 text-center rounded-lg font-bold hidden opacity-0 transition-opacity duration-300"></div>

            <!-- Bouton pour passer √† la question suivante -->
            <button id="next-button" 
                    class="w-full mt-6 py-3 px-6 bg-blue-600 text-white text-lg font-semibold rounded-xl hover:bg-blue-700 transition-colors duration-200 shadow-md hover:shadow-lg disabled:bg-gray-400"
                    disabled>
                Question Suivante
            </button>
        </div>

        <!-- Zone de R√©sultat (cach√©e au d√©but) -->
        <div id="result-area" class="text-center hidden">
            <h2 class="text-3xl font-bold text-blue-800 mb-4">Quiz Termin√© !</h2>
            <p id="final-score-text" class="text-2xl text-gray-700 mb-6"></p>
            <button id="restart-button" 
                    class="w-full py-3 px-6 bg-green-500 text-white text-lg font-semibold rounded-xl hover:bg-green-600 transition-colors duration-200 shadow-lg">
                Recommencer le Quiz (Nouvel Ordre)
            </button>
        </div>
    </div>

    <script>
        // D√©finition des 40 questions du Code de la route pour simuler l'examen
        const questions = [
            {
                question: "Que signifie un panneau triangulaire bord√© de rouge avec un point d'exclamation ?",
                options: ["Danger g√©n√©ral", "Priorit√© √† droite", "C√©dez le passage", "Travaux"],
                answer: "Danger g√©n√©ral"
            },
            {
                question: "Quelle est la vitesse maximale autoris√©e sur autoroute par temps sec pour un conducteur exp√©riment√© ?",
                options: ["130 km/h", "110 km/h", "100 km/h", "90 km/h"],
                answer: "130 km/h"
            },
            {
                question: "Que doit-on faire en pr√©sence d'un panneau 'Stop' ?",
                options: ["Ralentir et marquer le pas", "Marquer un arr√™t complet m√™me en l'absence de v√©hicule", "C√©der le passage si n√©cessaire", "S'arr√™ter seulement si un autre usager arrive"],
                answer: "Marquer un arr√™t complet m√™me en l'absence de v√©hicule"
            },
            {
                question: "En cas de panne sur la bande d'arr√™t d'urgence, dois-je placer le triangle de pr√©-signalisation ?",
                options: ["Oui, toujours √† 30 m√®tres", "Non, car c'est trop dangereux sur autoroute, je mets seulement les feux de d√©tresse", "Oui, √† 150 m√®tres", "Seulement si la visibilit√© est inf√©rieure √† 50 m√®tres"],
                answer: "Non, car c'est trop dangereux sur autoroute, je mets seulement les feux de d√©tresse"
            },
            {
                question: "En agglom√©ration, quelle est la vitesse maximale par d√©faut (sauf indication contraire) ?",
                options: ["70 km/h", "80 km/h", "50 km/h", "90 km/h"],
                answer: "50 km/h"
            },
            {
                question: "Quelle distance de s√©curit√© (en temps) est recommand√©e entre deux v√©hicules ?",
                options: ["1 seconde", "2 secondes", "3 secondes", "Le temps de dire 'un peu'"],
                answer: "2 secondes"
            },
            {
                question: "Le port de la ceinture de s√©curit√© est-il obligatoire pour tous les passagers (avant et arri√®re) ?",
                options: ["Oui", "Non, seulement √† l'avant", "Non, seulement en agglom√©ration", "Seulement si le v√©hicule en est √©quip√©"],
                answer: "Oui"
            },
            {
                question: "Que doit signaler un clignotant ?",
                options: ["Un changement de direction", "Un d√©passement", "Un arr√™t", "Toute modification de la trajectoire"],
                answer: "Toute modification de la trajectoire"
            },
            {
                question: "Vous circulez sur une route limit√©e √† 80 km/h. La distance d'arr√™t est d'environ : (Calcul simplifi√©)",
                options: ["20 m√®tres", "40 m√®tres", "60 m√®tres", "80 m√®tres"],
                answer: "60 m√®tres"
            },
            {
                question: "Un panneau rond √† fond bleu avec une fl√®che blanche vers le haut signifie :",
                options: ["Sens interdit", "Obligation d'aller tout droit", "Direction conseill√©e", "Voie sans issue"],
                answer: "Obligation d'aller tout droit"
            },
            {
                question: "Le taux d'alcool√©mie maximum autoris√© pour un jeune conducteur (permis probatoire) est de :",
                options: ["0,5 g/litre de sang", "0,8 g/litre de sang", "0,2 g/litre de sang", "0 g/litre de sang"],
                answer: "0,2 g/litre de sang"
            },
            {
                question: "En cas d'accident corporel, qui doit √™tre contact√© en premier ?",
                options: ["L'assureur", "Les secours (15, 18, 112)", "La gendarmerie/police", "Un proche"],
                answer: "Les secours (15, 18, 112)"
            },
            {
                question: "Que faire lorsque le feu de circulation est orange fixe ?",
                options: ["Acc√©l√©rer pour passer", "S'arr√™ter comme au feu rouge, sauf danger imm√©diat", "Passer sans ralentir", "C√©der le passage aux pi√©tons"],
                answer: "S'arr√™ter comme au feu rouge, sauf danger imm√©diat"
            },
            {
                question: "Un marquage au sol avec une ligne jaune discontinue le long du trottoir indique :",
                options: ["Arr√™t et stationnement interdits", "Stationnement autoris√© et limit√©", "Arr√™t autoris√© mais stationnement interdit", "Emplacement r√©serv√©"],
                answer: "Stationnement autoris√© et limit√©"
            },
            {
                question: "Le non-respect du port de la ceinture de s√©curit√© entra√Æne :",
                options: ["Un simple avertissement", "Une amende uniquement", "Une amende et un retrait de points", "Un retrait de permis"],
                answer: "Une amende et un retrait de points"
            },
            {
                question: "Quel est l'impact principal d'un pneu sous-gonfl√© ?",
                options: ["Meilleure tenue de route", "Diminution de la consommation de carburant", "Augmentation de la consommation de carburant et usure rapide", "Usure lente des freins"],
                answer: "Augmentation de la consommation de carburant et usure rapide"
            },
            {
                question: "Vous arrivez √† une intersection sans signalisation. Quelle est la r√®gle de priorit√© ?",
                options: ["Priorit√© √† gauche", "Priorit√© √† la signalisation verticale", "Priorit√© au plus rapide", "Priorit√© √† droite"],
                answer: "Priorit√© √† droite"
            },
            {
                question: "Lors d'un d√©passement, je dois m'assurer que :",
                options: ["La man≈ìuvre n'est pas trop longue", "Je ne suis pas moi-m√™me sur le point d'√™tre d√©pass√©", "Je peux me rabattre sans g√™ner", "Toutes ces r√©ponses"],
                answer: "Toutes ces r√©ponses"
            },
            {
                question: "Je suis le premier sur les lieux d'un accident. Ma premi√®re action est de :",
                options: ["Alerter les secours", "Prot√©ger la zone", "Secourir les victimes", "√âvaluer les d√©g√¢ts"],
                answer: "Prot√©ger la zone"
            },
            {
                question: "Dans un tunnel, en cas d'embouteillage, je dois :",
                options: ["Laisser le moteur tourner pour la ventilation", "√âteindre le moteur et allumer mes feux de d√©tresse", "Klaxonner pour alerter", "√âteindre mes feux et ouvrir les fen√™tres"],
                answer: "√âteindre le moteur et allumer mes feux de d√©tresse"
            },
            {
                question: "Le temps de r√©action moyen d'un conducteur est de :",
                options: ["0,5 seconde", "1 seconde", "1,5 seconde", "2 secondes"],
                answer: "1 seconde"
            },
            {
                question: "La conduite d'un v√©hicule sous l'emprise de stup√©fiants est punie de :",
                options: ["Uniquement une amende", "Uniquement un retrait de points", "Un retrait de permis et des peines de prison", "Un avertissement"],
                answer: "Un retrait de permis et des peines de prison"
            },
            {
                question: "Quelle est la limite de vitesse sur route √† double sens de circulation sans s√©parateur central, par temps de pluie ?",
                options: ["80 km/h", "70 km/h", "90 km/h", "110 km/h"],
                answer: "80 km/h"
            },
            {
                question: "Un panneau d'interdiction de stationner s'applique :",
                options: ["Uniquement c√¥t√© droit", "Des deux c√¥t√©s de la rue", "Uniquement apr√®s le panneau", "Uniquement avant le panneau"],
                answer: "Uniquement apr√®s le panneau"
            },
            {
                question: "Le voyant d'huile moteur s'allume en rouge. Que dois-je faire ?",
                options: ["Continuer prudemment jusqu'au garage le plus proche", "M'arr√™ter imm√©diatement et couper le contact", "Ajouter de l'huile moteur", "R√©trograder pour faire monter le moteur en r√©gime"],
                answer: "M'arr√™ter imm√©diatement et couper le contact"
            },
            {
                question: "Quand le stationnement est-il consid√©r√© comme 'g√™nant' ?",
                options: ["Quand il masque un panneau de signalisation", "Quand il est sur une place r√©serv√©e aux handicap√©s", "Quand il emp√™che l'acc√®s √† un autre v√©hicule", "Toutes ces r√©ponses"],
                answer: "Toutes ces r√©ponses"
            },
            {
                question: "Quelle est la distance minimale pour d√©passer un cycliste en agglom√©ration ?",
                options: ["50 cm", "1 m√®tre", "1,5 m√®tre", "2 m√®tres"],
                answer: "1 m√®tre"
            },
            {
                question: "Que signifie un panneau carr√© √† fond bleu avec une fl√®che blanche pointant vers le haut ?",
                options: ["Route prioritaire", "Voie rapide", "Sens unique", "Autoroute"],
                answer: "Sens unique"
            },
            {
                question: "Vous arrivez √† un feu tricolore qui passe au vert. Vous devez :",
                options: ["D√©marrer imm√©diatement", "V√©rifier que personne ne d√©boule ou ne finit de traverser", "Klaxonner pour acc√©l√©rer les autres conducteurs", "Passer sans regarder"],
                answer: "V√©rifier que personne ne d√©boule ou ne finit de traverser"
            },
            {
                question: "Quelle est l'utilit√© du contr√¥le technique obligatoire ?",
                options: ["V√©rifier l'√©tat de la carrosserie", "S'assurer que le v√©hicule respecte les normes de s√©curit√© et d'environnement", "D√©terminer la valeur du v√©hicule", "V√©rifier la validit√© de l'assurance"],
                answer: "S'assurer que le v√©hicule respecte les normes de s√©curit√© et d'environnement"
            },
            {
                question: "Quel est l'effet de la fatigue sur la conduite ?",
                options: ["Am√©lioration de la concentration", "Augmentation du temps de r√©action", "Diminution de la distance de freinage", "Meilleure anticipation"],
                answer: "Augmentation du temps de r√©action"
            },
            {
                question: "Sur une route √† chauss√©es s√©par√©es (route express), la vitesse maximale est de : (Conducteur exp√©riment√©)",
                options: ["90 km/h", "110 km/h", "120 km/h", "130 km/h"],
                answer: "110 km/h"
            },
            {
                question: "Je peux utiliser les feux de brouillard arri√®re :",
                options: ["D√®s qu'il pleut", "Uniquement en cas de brouillard ou de chute de neige", "Pour signaler un danger", "Quand il fait nuit"],
                answer: "Uniquement en cas de brouillard ou de chute de neige"
            },
            {
                question: "Le permis √† points est un syst√®me :",
                options: ["R√©guli√®rement augment√©", "D√©gressif, avec retrait de points en cas d'infraction", "Progressif, avec ajout de points chaque ann√©e", "Permanent sans r√©cup√©ration"],
                answer: "D√©gressif, avec retrait de points en cas d'infraction"
            },
            {
                question: "√Ä proximit√© d'un passage pi√©ton, je dois :",
                options: ["Acc√©l√©rer pour passer avant les pi√©tons", "M'arr√™ter si un pi√©ton est manifestement engag√© ou sur le point de l'√™tre", "Klaxonner pour avertir", "Continuer si la voie est libre"],
                answer: "M'arr√™ter si un pi√©ton est manifestement engag√© ou sur le point de l'√™tre"
            },
            {
                question: "Quelle est l'amende pour l'utilisation du t√©l√©phone tenu en main au volant ?",
                options: ["Une simple amende", "Une amende et un retrait de points", "Un retrait de permis", "Un avertissement"],
                answer: "Une amende et un retrait de points"
            },
            {
                question: "Un panneau B1 (rond, bord√© de rouge) indique :",
                options: ["Une obligation", "Une interdiction", "Un danger", "Une direction"],
                answer: "Une interdiction"
            },
            {
                question: "Je d√©passe un cyclomoteur. Je dois mettre mon clignotant :",
                options: ["Seulement pour me rabattre", "Pour d√©bo√Æter et pour me rabattre", "Seulement pour d√©bo√Æter", "Il n'est pas n√©cessaire de le mettre"],
                answer: "Pour d√©bo√Æter et pour me rabattre"
            },
            {
                question: "Comment doit √™tre charg√© un v√©hicule ?",
                options: ["Le chargement ne doit jamais d√©passer l'aplomb du v√©hicule", "Il doit √™tre bien arrim√© et ne pas masquer la visibilit√© ou les feux", "Il peut d√©passer de 3 m√®tres √† l'arri√®re sans signalisation", "Le chargement n'est pas r√©glement√©"],
                answer: "Il doit √™tre bien arrim√© et ne pas masquer la visibilit√© ou les feux"
            },
            {
                question: "Je suis oblig√© d'utiliser les feux de croisement :",
                options: ["D√®s qu'il fait nuit", "De jour, en cas de pluie ou de brouillard", "De nuit, sur route √©clair√©e ou non √©clair√©e, et dans les tunnels", "Toutes ces r√©ponses"],
                answer: "Toutes ces r√©ponses"
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let answered = false;
        let shuffledQuestions = []; // Tableau qui contiendra les questions m√©lang√©es

        // R√©cup√©ration des √©l√©ments du DOM
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const nextButton = document.getElementById('next-button');
        const scoreDisplay = document.getElementById('score-display');
        const indexDisplay = document.getElementById('question-index-display');
        const feedbackMessage = document.getElementById('feedback-message');
        const quizContainer = document.getElementById('quiz-container');
        const questionArea = document.getElementById('question-area');
        const resultArea = document.getElementById('result-area');
        const finalScoreText = document.getElementById('final-score-text');
        const restartButton = document.getElementById('restart-button');

        // Fonction pour m√©langer les √©l√©ments d'un tableau (Algorithme de Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Fonction d'initialisation du Quiz
        function initializeQuiz() {
            // 1. M√©langer les questions pour simuler les conditions r√©elles de l'examen
            shuffledQuestions = shuffleArray([...questions]);
            
            // 2. R√©initialiser les variables
            currentQuestionIndex = 0;
            score = 0;
            
            // 3. Charger la premi√®re question
            loadQuestion();
        }

        // Fonction pour charger la question actuelle
        function loadQuestion() {
            // Affichage de la zone de quiz et masquage des r√©sultats
            questionArea.classList.remove('hidden');
            resultArea.classList.add('hidden');

            answered = false;
            nextButton.disabled = true;
            // Masque et r√©initialise le message de feedback
            feedbackMessage.classList.add('hidden'); 
            feedbackMessage.classList.remove('opacity-100', 'bg-green-100', 'text-green-700', 'bg-red-100', 'text-red-700');
            
            const q = shuffledQuestions[currentQuestionIndex];
            
            // Mise √† jour du texte de la question et de l'index
            questionText.textContent = q.question;
            indexDisplay.textContent = `Question ${currentQuestionIndex + 1} / ${questions.length}`;
            scoreDisplay.textContent = `Score: ${score}`;

            // R√©initialisation des options et cr√©ation des nouveaux boutons
            optionsContainer.innerHTML = '';
            
            // M√©langer les options pour cette question
            const shuffledOptions = shuffleArray([...q.options]);

            shuffledOptions.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add(
                    'w-full', 'py-3', 'px-4', 'text-left', 'bg-gray-100', 'text-gray-800', 
                    'font-medium', 'rounded-lg', 'hover:bg-gray-200', 'transition-all', 
                    'duration-150', 'shadow-sm', 'border-2', 'border-transparent', 'focus:outline-none',
                    'active:bg-gray-300'
                );
                button.style.pointerEvents = 'auto'; 
                button.addEventListener('click', () => checkAnswer(button, option, q.answer));
                optionsContainer.appendChild(button);
            });
        }

        // Fonction pour v√©rifier la r√©ponse de l'utilisateur
        function checkAnswer(selectedButton, selectedOption, correctAnswer) {
            if (answered) return;
            answered = true;
            nextButton.disabled = false;

            // D√©sactiver tous les boutons d'option apr√®s la s√©lection
            Array.from(optionsContainer.children).forEach(btn => {
                btn.style.pointerEvents = 'none';
                btn.classList.remove('hover:bg-gray-200', 'active:bg-gray-300');
                
                // R√©v√©ler la r√©ponse correcte
                if (btn.textContent === correctAnswer) {
                    btn.classList.add('bg-green-100', 'border-green-500', 'shadow-lg');
                }
            });

            // G√©rer le feedback
            if (selectedOption === correctAnswer) {
                score++;
                scoreDisplay.textContent = `Score: ${score}`;
                selectedButton.classList.add('bg-green-500', 'text-white', 'shadow-xl', 'border-green-700');
                feedbackMessage.textContent = "‚úÖ Correct ! Bonne r√©ponse.";
                feedbackMessage.classList.remove('hidden');
                feedbackMessage.classList.add('bg-green-100', 'text-green-700', 'opacity-100');

            } else {
                // Si la r√©ponse est fausse, marquer la s√©lection de l'utilisateur en rouge
                selectedButton.classList.add('bg-red-500', 'text-white', 'shadow-xl', 'border-red-700');
                feedbackMessage.textContent = "‚ùå Incorrect. La bonne r√©ponse est marqu√©e en vert.";
                feedbackMessage.classList.remove('hidden');
                feedbackMessage.classList.add('bg-red-100', 'text-red-700', 'opacity-100');
            }
        }

        // Fonction pour afficher les r√©sultats finaux
        function showResult() {
            questionArea.classList.add('hidden');
            resultArea.classList.remove('hidden');

            const errors = questions.length - score;
            const passingScore = 35;
            const success = score >= passingScore;
            
            let message = `<p class="text-3xl font-bold mb-3">${score} / ${questions.length}</p>`;
            message += `<p class="text-xl">Erreurs commises : <span class="font-extrabold ${success ? 'text-green-600' : 'text-red-600'}">${errors}</span></p>`;
            
            if (success) {
                message += `<p class="mt-4 text-green-700 text-2xl font-bold">üéâ R√âUSSITE ! Vous avez moins de 5 erreurs, comme √† l'examen !</p>`;
            } else {
                message += `<p class="mt-4 text-red-700 text-2xl font-bold">‚ö†Ô∏è √âCHEC. Vous avez ${errors} erreurs. Le maximum autoris√© est 5.</p>`;
                message += `<p class="text-lg mt-2">Continuez de r√©viser les th√®mes moins ma√Ætris√©s pour atteindre l'objectif de 35/40.</p>`;
            }
            
            finalScoreText.innerHTML = message;
        }

        // Gestionnaire d'√©v√©nement pour le bouton "Suivante"
        nextButton.addEventListener('click', () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showResult();
            }
        });

        // Gestionnaire d'√©v√©nement pour le bouton "Recommencer"
        restartButton.addEventListener('click', initializeQuiz);

        // D√©marrage de l'application au chargement de la page
        window.onload = initializeQuiz;

    </script>
</body>
</html>
